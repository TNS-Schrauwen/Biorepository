#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

# Final Merge To Create Visual File Step 7 Part 2 SubPart 2

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

# Paths
## Using Step 07 Part 1 SubStep 2 tsv file
Step_1___Merged <- "/path/to/Step_07___MergeIn/TypeOf_PreFiltration/Part_1___MergeInStep1FilesIntoOneDataSet/SubPart_2___MergingStep1FilesIntoOneDataSet/Output_File.tsv"

## Using Step 07 Part 0 tsv file
MergedInEditedNonEditedCountsAndProportions <- "/path/to/Step_07___MergeIn/Basic_PreFiltration/Part_0___Editing_Frequency_And_Non_Edited_Count_And_Edited_Count_PerSample_MergedToSixREDITOutputs/Part_0___MergedStepSixDataWithProcessedColumns_TypeOfPrefiltration.tsv"

# Replace the actual path to your output directory In Step 07 folder called Part_2__DescriptionOfYourChoice
output_directory <- "/path/to/Step_07___MergeIn/Basic_PreFiltration/Part_2___MergingOutputsFromStep7Part0AndPart1"

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

## Check if the files exist

if (file.exists(Step_1___Merged)) {
  cat("*Path To Step 1 Merged File:*", Step_1___Merged, "\n")
} else {
  cat("File does not exist at", Step_1___Merged, "\n")
  stop("Exiting script. File not found.")
}

if (file.exists(MergedInEditedNonEditedCountsAndProportions)) {
  cat("*Path To Merged In Edited And Non-Edited Counts And Editing Proportions File:*", MergedInEditedNonEditedCountsAndProportions, "\n")
} else {
  cat("File does not exist at", MergedInEditedNonEditedCountsAndProportions, "\n")
  stop("Exiting script. File not found.")
}

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

library(dplyr)

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

# Read the first file into a data frame
Step_1___Merged_data <- read.table(Step_1___Merged, header = TRUE, sep = "\t")

# Read the second file into a data frame
MergedInEditedNonEditedCountsAndProportions_data <- read.table(MergedInEditedNonEditedCountsAndProportions, header = TRUE, sep = "\t")

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

# Skip two lines before printing the statement
cat("\n\nStep_1___Merged Data:\n")
# Print the first few rows of the data frame
print(head(Step_1___Merged_data))

# Skip two lines before printing the statement
cat("\n\nMerged In Edited and Non Edited Counts And Edited Proportions Data:\n")
# Print the first few rows of the data frame
print(head(MergedInEditedNonEditedCountsAndProportions_data))

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

# Create a new column "Region_Position" in the first data frame
Step_1___Merged_data <- mutate(Step_1___Merged_data, Region_Position = paste(Region, Position, sep = "_"))

# Remove the old "Region" and "Position" columns
Step_1___Merged_data <- select(Step_1___Merged_data, -Region, -Position)

# Skip two lines before printing the statement
cat("\n\nStep 1 Data Renamed\n")

# Print the updated data frame
print(head(Step_1___Merged_data))

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

# Full Merge

Full_Merged <- merge(Step_1___Merged_data, MergedInEditedNonEditedCountsAndProportions_data,
                     by.x = c("Region_Position"), by.y = c("Region"))

# Skip two lines before printing the statement
cat("\n\nFull_Merged Data:\n")

# Print the first few rows of the merged data
print(head(Full_Merged))

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

# Write Full_Merged to a tsv file
tsv_file_path <- file.path(output_directory, "Full_Merged.tsv")
write.table(Full_Merged, tsv_file_path, sep = "\t", quote = FALSE, row.names = FALSE)

# Write Full_Merged to a csv file
csv_file_path <- file.path(output_directory, "Full_Merged.csv")
write.csv(Full_Merged, csv_file_path, row.names = FALSE)

cat("*Fully merged data has been written to:* \n", tsv_file_path, "\n", csv_file_path, "\n")

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

# Skip two lines before printing the statement
cat("\n\n*Session Information:*\n")

# Print the session information
print(sessionInfo())

#__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________